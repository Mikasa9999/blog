---
interface Props {
  title: string;
  description?: string;
  backgroundType?: 'home' | 'category' | 'article' | 'search' | 'about' | 'none';
}

const { title, description, backgroundType = 'home' } = Astro.props;
---

<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description || "AI/ML çŸ¥è¯†åšå®¢"} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous" />
    <title>{title}</title>
    <style>
      /* è‡ªå®šä¹‰åŠ¨ç”» */
      @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(180deg); }
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-float {
        animation: float 6s ease-in-out infinite;
      }
      .animate-fade-in {
        animation: fadeIn 0.8s ease-out forwards;
      }
      .animation-delay-200 {
        animation-delay: 0.2s;
      }
      .animation-delay-400 {
        animation-delay: 0.4s;
      }
      .animation-delay-1000 {
        animation-delay: 1s;
      }
      .animation-delay-2000 {
        animation-delay: 2s;
      }

      /* æ–‡æœ¬æˆªæ–­æ ·å¼ */
      .line-clamp-1 {
        overflow: hidden;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 1;
      }
      .line-clamp-2 {
        overflow: hidden;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
      }
      .line-clamp-3 {
        overflow: hidden;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 3;
      }

      /* Markdown å…ƒç´ è¾¹æ¡†æ ·å¼ */
      .prose pre {
        border: 1px solid rgb(209 213 219);
        border-radius: 0.5rem;
        background-color: rgb(249 250 251) !important;
      }
      .dark .prose pre {
        border-color: rgb(55 65 81);
        background-color: rgb(31 41 55) !important;
      }
      .prose blockquote {
        border-left: 4px solid rgb(59 130 246);
        background-color: rgb(239 246 255);
        border-radius: 0.375rem;
      }
      .dark .prose blockquote {
        border-left-color: rgb(96 165 250);
        background-color: rgb(30 58 138);
      }
      .prose table {
        border: 1px solid rgb(209 213 219);
        border-radius: 0.5rem;
        overflow: hidden;
      }
      .dark .prose table {
        border-color: rgb(55 65 81);
      }
      .prose table th,
      .prose table td {
        border: 1px solid rgb(209 213 219);
      }
      .dark .prose table th,
      .dark .prose table td {
        border-color: rgb(55 65 81);
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-primary-50 via-white to-accent-50/30 dark:from-primary-950 dark:via-primary-900 dark:to-accent-900/20 text-primary-900 dark:text-primary-50 transition-colors duration-300 relative">
    <!-- èƒŒæ™¯å›¾ç‰‡å±‚ -->
    {backgroundType !== 'none' && (
      <div class="fixed inset-0 -z-20 overflow-hidden">
        <!-- æµ…è‰²æ¨¡å¼èƒŒæ™¯å›¾ç‰‡ -->
        <div class="absolute inset-0 bg-cover bg-center bg-no-repeat transition-opacity duration-500 dark:opacity-0"
             style={`background-image: url('/backgrounds/${backgroundType}-light.jpg')`}>
        </div>

        <!-- æ·±è‰²æ¨¡å¼èƒŒæ™¯å›¾ç‰‡ - å¦‚æœä¸å­˜åœ¨åˆ™ä½¿ç”¨æµ…è‰²å›¾ç‰‡ -->
        <div class="absolute inset-0 bg-cover bg-center bg-no-repeat transition-opacity duration-500 opacity-0 dark:opacity-100"
             style={`background-image: url('/backgrounds/${backgroundType}-dark.jpg'), url('/backgrounds/${backgroundType}-light.jpg')`}>
        </div>
      </div>
    )}

    <!-- èƒŒæ™¯è£…é¥°å…ƒç´  -->
    <div class="fixed inset-0 -z-10 overflow-hidden">
      <!-- ç½‘æ ¼èƒŒæ™¯ -->
      <div class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.03)_1px,transparent_1px)] bg-[size:64px_64px] [mask-image:radial-gradient(ellipse_80%_50%_at_50%_50%,black,transparent)] dark:bg-[linear-gradient(rgba(255,255,255,0.05)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.05)_1px,transparent_1px)]"></div>

      <!-- æ¸å˜å…‰æ–‘ -->
      <div class="absolute -top-40 -right-40 w-80 h-80 bg-accent-400/20 rounded-full blur-3xl dark:bg-accent-600/10"></div>
      <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-blue-400/20 rounded-full blur-3xl dark:bg-blue-600/10"></div>
      <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl dark:bg-purple-600/5"></div>
    </div>
    <header class="border-b border-primary-200 dark:border-primary-700 bg-white dark:bg-primary-900 sticky top-0 z-40">
      <nav class="container mx-auto px-4 py-3">
        <div class="flex justify-between items-center">
          <a href="/" class="text-lg font-semibold text-primary-900 dark:text-primary-50 hover:text-primary-700 dark:hover:text-primary-300 transition-colors duration-200 flex items-center space-x-2">
            <div class="w-5 h-5 bg-primary-600 dark:bg-primary-400 rounded flex items-center justify-center text-white text-xs font-medium">
              çŸ¥
            </div>
            <span>lightçš„çŸ¥è¯†åšå®¢</span>
          </a>
          <div class="flex items-center space-x-4">
            <a href="/" class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800">
              é¦–é¡µ
            </a>

            <!-- åˆ†ç±»ä¸‹æ‹‰èœå• -->
            <div class="relative group">
              <button class="flex items-center text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800">
                åˆ†ç±»
                <svg class="w-3 h-3 ml-1 group-hover:rotate-180 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="absolute top-full left-0 mt-1 w-48 bg-white dark:bg-primary-800 border border-primary-200 dark:border-primary-700 rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                <div class="py-1">
                  <a href="/theory" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-150">
                    ç†è®ºåŸºç¡€
                  </a>
                  <a href="/models" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-green-50 dark:hover:bg-green-900/20 hover:text-green-600 dark:hover:text-green-400 transition-colors duration-150">
                    ç®—æ³•ä¸æ¨¡å‹
                  </a>
                  <a href="/practice" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 hover:text-purple-600 dark:hover:text-purple-400 transition-colors duration-150">
                    å®æˆ˜ä¸åº”ç”¨
                  </a>
                  <a href="/tools" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 transition-colors duration-150">
                    å·¥å…·ä¸æ¡†æ¶
                  </a>
                  <a href="/insights" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-pink-50 dark:hover:bg-pink-900/20 hover:text-pink-600 dark:hover:text-pink-400 transition-colors duration-150">
                    æ€è€ƒä¸æ´è§
                  </a>
                </div>
              </div>
            </div>

            <a href="/search" class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800">
              æœç´¢
            </a>
            <a href="/about" class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800">
              å…³äº
            </a>
            <button id="theme-toggle" class="p-1 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800 transition-colors duration-200">
              <span class="dark:hidden text-sm">ğŸŒ™</span>
              <span class="hidden dark:inline text-sm">â˜€ï¸</span>
            </button>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <slot />
    </main>

    <footer class="border-t border-primary-200 dark:border-primary-700 mt-16">
      <div class="container mx-auto px-4 py-8 text-center text-primary-600 dark:text-primary-400">
        <p>&copy; 2024 AI/ML çŸ¥è¯†åšå®¢. åŸºäº Astro æ„å»º.</p>
      </div>
    </footer>

    <script>
      // ä¸»é¢˜åˆ‡æ¢é€»è¾‘
      const themeToggle = document.getElementById('theme-toggle');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');

      function setTheme(theme) {
        document.documentElement.classList.toggle('dark', theme === 'dark');
        localStorage.setItem('theme', theme);
      }

      const savedTheme = localStorage.getItem('theme') || (prefersDark.matches ? 'dark' : 'light');
      setTheme(savedTheme);

      themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
        setTheme(currentTheme);
      });
    </script>
  </body>
</html>