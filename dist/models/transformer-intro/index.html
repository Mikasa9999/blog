<!DOCTYPE html><html lang="zh-CN" class="scroll-smooth" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="description" content="æ·±å…¥è§£æ Transformer æ¨¡å‹çš„æ ¸å¿ƒåŸç†ï¼ŒåŒ…æ‹¬è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€ä½ç½®ç¼–ç ã€å¤šå¤´æ³¨æ„åŠ›ç­‰å…³é”®ç»„ä»¶ï¼Œä»¥åŠå…¶åœ¨ç°ä»£ NLP ä¸­çš„åº”ç”¨ã€‚"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous"><title>Transformer æ¨¡å‹è¯¦è§£ï¼šä»æ³¨æ„åŠ›æœºåˆ¶åˆ°ç°ä»£æ¶æ„ | lightçš„çŸ¥è¯†åšå®¢</title><link rel="stylesheet" href="/_astro/_slug_.Dypz7GXS.css"><script type="module" src="/_astro/hoisted.n3v2uKZh.js"></script></head> <body class="bg-gradient-to-br from-primary-50 via-white to-accent-50/30 dark:from-primary-950 dark:via-primary-900 dark:to-accent-900/20 text-primary-900 dark:text-primary-50 transition-colors duration-300 relative" data-astro-cid-sckkx6r4> <!-- èƒŒæ™¯å›¾ç‰‡å±‚ -->  <!-- èƒŒæ™¯è£…é¥°å…ƒç´  --> <div class="fixed inset-0 -z-10 overflow-hidden" data-astro-cid-sckkx6r4> <!-- ç½‘æ ¼èƒŒæ™¯ --> <div class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.03)_1px,transparent_1px)] bg-[size:64px_64px] [mask-image:radial-gradient(ellipse_80%_50%_at_50%_50%,black,transparent)] dark:bg-[linear-gradient(rgba(255,255,255,0.05)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.05)_1px,transparent_1px)]" data-astro-cid-sckkx6r4></div> <!-- æ¸å˜å…‰æ–‘ --> <div class="absolute -top-40 -right-40 w-80 h-80 bg-accent-400/20 rounded-full blur-3xl dark:bg-accent-600/10" data-astro-cid-sckkx6r4></div> <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-blue-400/20 rounded-full blur-3xl dark:bg-blue-600/10" data-astro-cid-sckkx6r4></div> <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl dark:bg-purple-600/5" data-astro-cid-sckkx6r4></div> </div> <header class="border-b border-primary-200 dark:border-primary-700 bg-white dark:bg-primary-900 sticky top-0 z-40" data-astro-cid-sckkx6r4> <nav class="container mx-auto px-4 py-3" data-astro-cid-sckkx6r4> <div class="flex justify-between items-center" data-astro-cid-sckkx6r4> <a href="/" class="text-lg font-semibold text-primary-900 dark:text-primary-50 hover:text-primary-700 dark:hover:text-primary-300 transition-colors duration-200 flex items-center space-x-2" data-astro-cid-sckkx6r4> <div class="w-5 h-5 bg-primary-600 dark:bg-primary-400 rounded flex items-center justify-center text-white text-xs font-medium" data-astro-cid-sckkx6r4>
çŸ¥
</div> <span data-astro-cid-sckkx6r4>lightçš„çŸ¥è¯†åšå®¢</span> </a> <div class="flex items-center space-x-4" data-astro-cid-sckkx6r4> <a href="/" class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800" data-astro-cid-sckkx6r4>
é¦–é¡µ
</a> <!-- åˆ†ç±»ä¸‹æ‹‰èœå• --> <div class="relative group" data-astro-cid-sckkx6r4> <button class="flex items-center text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800" data-astro-cid-sckkx6r4>
åˆ†ç±»
<svg class="w-3 h-3 ml-1 group-hover:rotate-180 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-sckkx6r4> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" data-astro-cid-sckkx6r4></path> </svg> </button> <div class="absolute top-full left-0 mt-1 w-48 bg-white dark:bg-primary-800 border border-primary-200 dark:border-primary-700 rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50" data-astro-cid-sckkx6r4> <div class="py-1" data-astro-cid-sckkx6r4> <a href="/theory" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-150" data-astro-cid-sckkx6r4>
ç†è®ºåŸºç¡€
</a> <a href="/models" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-green-50 dark:hover:bg-green-900/20 hover:text-green-600 dark:hover:text-green-400 transition-colors duration-150" data-astro-cid-sckkx6r4>
ç®—æ³•ä¸æ¨¡å‹
</a> <a href="/practice" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 hover:text-purple-600 dark:hover:text-purple-400 transition-colors duration-150" data-astro-cid-sckkx6r4>
å®æˆ˜ä¸åº”ç”¨
</a> <a href="/tools" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 transition-colors duration-150" data-astro-cid-sckkx6r4>
å·¥å…·ä¸æ¡†æ¶
</a> <a href="/insights" class="block px-3 py-2 text-sm text-primary-600 dark:text-primary-400 hover:bg-pink-50 dark:hover:bg-pink-900/20 hover:text-pink-600 dark:hover:text-pink-400 transition-colors duration-150" data-astro-cid-sckkx6r4>
æ€è€ƒä¸æ´è§
</a> </div> </div> </div> <a href="/search" class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800" data-astro-cid-sckkx6r4>
æœç´¢
</a> <a href="/about" class="text-sm text-primary-600 dark:text-primary-400 hover:text-primary-900 dark:hover:text-primary-50 transition-colors duration-200 py-1 px-2 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800" data-astro-cid-sckkx6r4>
å…³äº
</a> <button id="theme-toggle" class="p-1 rounded-md hover:bg-primary-100 dark:hover:bg-primary-800 transition-colors duration-200" data-astro-cid-sckkx6r4> <span class="dark:hidden text-sm" data-astro-cid-sckkx6r4>ğŸŒ™</span> <span class="hidden dark:inline text-sm" data-astro-cid-sckkx6r4>â˜€ï¸</span> </button> </div> </div> </nav> </header> <main data-astro-cid-sckkx6r4>  <div class="max-w-4xl mx-auto px-6 py-8"> <article class="bg-white dark:bg-primary-800 border border-primary-200 dark:border-primary-700 rounded-lg p-8"> <header class="mb-8"> <div class="flex items-center space-x-4 mb-4"> <span class="px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"> models </span> <time class="text-primary-600 dark:text-primary-400 text-sm"> 2024å¹´10æœˆ1æ—¥ </time> </div> <h1 class="text-3xl font-bold text-primary-900 dark:text-primary-50 mb-4"> Transformer æ¨¡å‹è¯¦è§£ï¼šä»æ³¨æ„åŠ›æœºåˆ¶åˆ°ç°ä»£æ¶æ„ </h1> <p class="text-lg text-primary-600 dark:text-primary-400 leading-relaxed"> æ·±å…¥è§£æ Transformer æ¨¡å‹çš„æ ¸å¿ƒåŸç†ï¼ŒåŒ…æ‹¬è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€ä½ç½®ç¼–ç ã€å¤šå¤´æ³¨æ„åŠ›ç­‰å…³é”®ç»„ä»¶ï¼Œä»¥åŠå…¶åœ¨ç°ä»£ NLP ä¸­çš„åº”ç”¨ã€‚ </p> <div class="flex flex-wrap gap-2 mt-6"> <span class="px-3 py-1 bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 rounded-full text-sm">
#transformer </span><span class="px-3 py-1 bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 rounded-full text-sm">
#attention </span><span class="px-3 py-1 bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 rounded-full text-sm">
#nlp </span><span class="px-3 py-1 bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 rounded-full text-sm">
#deep-learning </span><span class="px-3 py-1 bg-primary-100 dark:bg-primary-800 text-primary-700 dark:text-primary-300 rounded-full text-sm">
#sequence-modeling </span> </div> </header> <!-- æ–‡ç« å†…å®¹ --> <div class="border-t border-primary-200 dark:border-primary-700 pt-8"> <div class="prose prose-lg dark:prose-invert max-w-none"> <h1 id="transformer-æ¨¡å‹è¯¦è§£">Transformer æ¨¡å‹è¯¦è§£</h1>
<p>Transformer æ¨¡å‹æ˜¯è¿‘å¹´æ¥è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸæœ€é‡è¦çš„çªç ´ä¹‹ä¸€ï¼Œå®ƒå½»åº•æ”¹å˜äº†åºåˆ—å»ºæ¨¡çš„æ–¹å¼ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æ Transformer çš„æ ¸å¿ƒåŸç†å’Œæ¶æ„è®¾è®¡ã€‚
<img  src="/_astro/image.Dg3v3yHJ_2rqbyO.webp" alt="alt text" width="862" height="1286" loading="lazy" decoding="async"></p>
<h2 id="è‡ªæ³¨æ„åŠ›æœºåˆ¶">è‡ªæ³¨æ„åŠ›æœºåˆ¶</h2>
<p>è‡ªæ³¨æ„åŠ›æœºåˆ¶æ˜¯ Transformer çš„æ ¸å¿ƒï¼Œå®ƒå…è®¸æ¨¡å‹åœ¨å¤„ç†åºåˆ—æ—¶å…³æ³¨åˆ°åºåˆ—ä¸­çš„å…¶ä»–ä½ç½®ã€‚</p>
<h3 id="ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›">ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> torch</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> torch.nn.functional </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> F</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> scaled_dot_product_attention</span><span style="color:#E1E4E8">(query, key, value, mask</span><span style="color:#F97583">=</span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›å®ç°"""</span></span>
<span class="line"><span style="color:#E1E4E8">    d_k </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> query.size(</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    scores </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> torch.matmul(query, key.transpose(</span><span style="color:#F97583">-</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)) </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> math.sqrt(d_k)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> mask </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        scores </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> scores.masked_fill(mask </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">-</span><span style="color:#79B8FF">1e9</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    attention_weights </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> F.softmax(scores, </span><span style="color:#FFAB70">dim</span><span style="color:#F97583">=-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    output </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> torch.matmul(attention_weights, value)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> output, attention_weights</span></span>
<span class="line"></span></code></pre>
<h3 id="å¤šå¤´æ³¨æ„åŠ›">å¤šå¤´æ³¨æ„åŠ›</h3>
<p>å¤šå¤´æ³¨æ„åŠ›é€šè¿‡å¹¶è¡Œè¿è¡Œå¤šä¸ªæ³¨æ„åŠ›å¤´æ¥æ•æ‰ä¸åŒç±»å‹çš„ä¿¡æ¯ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> MultiHeadAttention</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">nn</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Module</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self, d_model, num_heads):</span></span>
<span class="line"><span style="color:#79B8FF">        super</span><span style="color:#E1E4E8">().</span><span style="color:#79B8FF">__init__</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.num_heads </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> num_heads</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.d_model </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> d_model</span></span>
<span class="line"><span style="color:#F97583">        assert</span><span style="color:#E1E4E8"> d_model </span><span style="color:#F97583">%</span><span style="color:#E1E4E8"> num_heads </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.depth </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> d_model </span><span style="color:#F97583">//</span><span style="color:#E1E4E8"> num_heads</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.wq </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Linear(d_model, d_model)</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.wk </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Linear(d_model, d_model)</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.wv </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Linear(d_model, d_model)</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.dense </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Linear(d_model, d_model)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> split_heads</span><span style="color:#E1E4E8">(self, x, batch_size):</span></span>
<span class="line"><span style="color:#E1E4E8">        x </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x.view(batch_size, </span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.num_heads, </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.depth)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> x.transpose(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> forward</span><span style="color:#E1E4E8">(self, q, k, v, mask):</span></span>
<span class="line"><span style="color:#E1E4E8">        batch_size </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> q.size(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        q </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.split_heads(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.wq(q), batch_size)</span></span>
<span class="line"><span style="color:#E1E4E8">        k </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.split_heads(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.wk(k), batch_size)</span></span>
<span class="line"><span style="color:#E1E4E8">        v </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.split_heads(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.wv(v), batch_size)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        scaled_attention, attention_weights </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> scaled_dot_product_attention(</span></span>
<span class="line"><span style="color:#E1E4E8">            q, k, v, mask</span></span>
<span class="line"><span style="color:#E1E4E8">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        scaled_attention </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> scaled_attention.transpose(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">).contiguous().view(</span></span>
<span class="line"><span style="color:#E1E4E8">            batch_size, </span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.d_model</span></span>
<span class="line"><span style="color:#E1E4E8">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        output </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.dense(scaled_attention)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> output, attention_weights</span></span>
<span class="line"></span></code></pre>
<h2 id="ä½ç½®ç¼–ç ">ä½ç½®ç¼–ç </h2>
<p>ç”±äº Transformer ä¸åŒ…å«å¾ªç¯æˆ–å·ç§¯ç»“æ„ï¼Œéœ€è¦ä½ç½®ç¼–ç æ¥æä¾›åºåˆ—çš„ä½ç½®ä¿¡æ¯ï¼š</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator="true">,</mo><mn>2</mn><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mi>sin</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><msup><mn>10000</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">PE_{(pos,2i)} = \sin\left(\frac{pos}{10000^{2i/d_{model}}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.5648em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932em;"><span style="top:-2.8932em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6944em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3496em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4352em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator="true">,</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mi>cos</mi><mo>â¡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><msup><mn>10000</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">PE_{(pos,2i+1)} = \cos\left(\frac{pos}{10000^{2i/d_{model}}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.5648em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932em;"><span style="top:-2.8932em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6944em;"></span><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3496em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4352em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></p>
<h2 id="ç¼–ç å™¨-è§£ç å™¨æ¶æ„">ç¼–ç å™¨-è§£ç å™¨æ¶æ„</h2>
<p>Transformer é‡‡ç”¨ç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼š</p>
<ul>
<li><strong>ç¼–ç å™¨</strong>ï¼šç”± N ä¸ªç›¸åŒçš„å±‚ç»„æˆï¼Œæ¯å±‚åŒ…å«å¤šå¤´è‡ªæ³¨æ„åŠ›å’Œå‰é¦ˆç½‘ç»œ</li>
<li><strong>è§£ç å™¨</strong>ï¼šåŒæ ·ç”± N ä¸ªç›¸åŒçš„å±‚ç»„æˆï¼Œä½†åŒ…å«é¢å¤–çš„ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›å±‚</li>
</ul>
<h2 id="å‰é¦ˆç½‘ç»œ">å‰é¦ˆç½‘ç»œ</h2>
<p>æ¯ä¸ªæ³¨æ„åŠ›å±‚åé¢éƒ½è·Ÿç€ä¸€ä¸ªå‰é¦ˆç½‘ç»œï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> FeedForward</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">nn</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Module</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self, d_model, d_ff, dropout</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0.1</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#79B8FF">        super</span><span style="color:#E1E4E8">().</span><span style="color:#79B8FF">__init__</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.linear1 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Linear(d_model, d_ff)</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.linear2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Linear(d_ff, d_model)</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.dropout </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Dropout(dropout)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> forward</span><span style="color:#E1E4E8">(self, x):</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.linear2(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.dropout(F.relu(</span><span style="color:#79B8FF">self</span><span style="color:#E1E4E8">.linear1(x))))</span></span>
<span class="line"></span></code></pre>
<h2 id="æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–">æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–</h2>
<p>æ¯ä¸ªå­å±‚éƒ½é‡‡ç”¨æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">class</span><span style="color:#B392F0"> LayerNorm</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">nn</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">Module</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#79B8FF"> __init__</span><span style="color:#E1E4E8">(self, features, eps</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1e-6</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#79B8FF">        super</span><span style="color:#E1E4E8">().</span><span style="color:#79B8FF">__init__</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.a_2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Parameter(torch.ones(features))</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.b_2 </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> nn.Parameter(torch.zeros(features))</span></span>
<span class="line"><span style="color:#79B8FF">        self</span><span style="color:#E1E4E8">.eps </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> eps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> forward</span><span style="color:#E1E4E8">(self, x):</span></span>
<span class="line"><span style="color:#E1E4E8">        mean </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x.mean(</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">keepdim</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        std </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> x.std(</span><span style="color:#F97583">-</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">keepdim</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.a_2 </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> (x </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> mean) </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> (std </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.eps) </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> self</span><span style="color:#E1E4E8">.b_2</span></span>
<span class="line"></span></code></pre>
<h2 id="ç°ä»£å˜ä½“">ç°ä»£å˜ä½“</h2>
<h3 id="bert">BERT</h3>
<ul>
<li>ä»…ä½¿ç”¨ç¼–ç å™¨</li>
<li>åŒå‘ä¸Šä¸‹æ–‡ç†è§£</li>
<li>é¢„è®­ç»ƒ + å¾®è°ƒèŒƒå¼</li>
</ul>
<h3 id="gpt-ç³»åˆ—">GPT ç³»åˆ—</h3>
<ul>
<li>ä»…ä½¿ç”¨è§£ç å™¨</li>
<li>è‡ªå›å½’ç”Ÿæˆ</li>
<li>å¤§è§„æ¨¡é¢„è®­ç»ƒ</li>
</ul>
<h3 id="t5">T5</h3>
<ul>
<li>æ–‡æœ¬åˆ°æ–‡æœ¬çš„ç»Ÿä¸€æ¡†æ¶</li>
<li>å°†æ‰€æœ‰ NLP ä»»åŠ¡è½¬æ¢ä¸ºæ–‡æœ¬ç”Ÿæˆ</li>
</ul>
<h2 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</h2>
<ol>
<li><strong>æœºå™¨ç¿»è¯‘</strong>ï¼šåŸå§‹ Transformer çš„ä¸»è¦åº”ç”¨</li>
<li><strong>æ–‡æœ¬ç”Ÿæˆ</strong>ï¼šGPT ç³»åˆ—çš„æˆåŠŸåº”ç”¨</li>
<li><strong>æ–‡æœ¬åˆ†ç±»</strong>ï¼šBERT åœ¨å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸­è¡¨ç°ä¼˜å¼‚</li>
<li><strong>é—®ç­”ç³»ç»Ÿ</strong>ï¼šé˜…è¯»ç†è§£ä»»åŠ¡</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šGitHub Copilot ç­‰å·¥å…·</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Transformer æ¨¡å‹é€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶å®ç°äº†é«˜æ•ˆçš„åºåˆ—å»ºæ¨¡ï¼Œæ‘†è„±äº† RNN çš„é¡ºåºå¤„ç†é™åˆ¶ã€‚å…¶å¹¶è¡ŒåŒ–ç‰¹æ€§ä½¿å¾—è®­ç»ƒå¤§è§„æ¨¡æ¨¡å‹æˆä¸ºå¯èƒ½ï¼Œæ¨åŠ¨äº†ç°ä»£ NLP çš„å‘å±•ã€‚ç†è§£ Transformer çš„æ ¸å¿ƒåŸç†å¯¹äºæŒæ¡ç°ä»£æ·±åº¦å­¦ä¹ æŠ€æœ¯è‡³å…³é‡è¦ã€‚</p> </div> </div> <!-- æ–‡ç« åº•éƒ¨ --> <footer class="border-t border-primary-200 dark:border-primary-700 mt-8 pt-8"> <div class="flex justify-between items-center text-sm text-primary-500 dark:text-primary-400"> <span>å‘å¸ƒäº 2024/10/1</span> <span>æ›´æ–°äº 2024/10/5</span> </div> </footer> </article> </div>  </main> <footer class="border-t border-primary-200 dark:border-primary-700 mt-16" data-astro-cid-sckkx6r4> <div class="container mx-auto px-4 py-8 text-center text-primary-600 dark:text-primary-400" data-astro-cid-sckkx6r4> <p data-astro-cid-sckkx6r4>&copy; 2024 AI/ML çŸ¥è¯†åšå®¢. åŸºäº Astro æ„å»º.</p> </div> </footer>  </body> </html>